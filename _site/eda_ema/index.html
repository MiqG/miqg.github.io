<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.19.2 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Dissecting 28 years of European pharmaceutical development - Miquel Anglada Girotto</title>
<meta name="description" content="European Medicines Agency, EMA, drug development, orphan drugs ">


  <meta name="author" content="Miquel Anglada Girotto">


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Miquel Anglada Girotto">
<meta property="og:title" content="Dissecting 28 years of European pharmaceutical development">
<meta property="og:url" content="http://localhost:4000/eda_ema/">


  <meta property="og:description" content="European Medicines Agency, EMA, drug development, orphan drugs ">



  <meta property="og:image" content="http://localhost:4000/images/lab.JPG">





  <meta property="article:published_time" content="2020-05-21T00:00:00+02:00">





  

  


<link rel="canonical" href="http://localhost:4000/eda_ema/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Miquel Anglada Girotto",
      "url": "http://localhost:4000/"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Miquel Anglada Girotto Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->
<link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic:wght@400;700&display=swap" rel="stylesheet">
<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Miquel Anglada Girotto
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/learning-by-doing/">LEARNING BY DOING</a>
            </li><li class="masthead__menu-item">
              <a href="/projects/">PROJECTS</a>
            </li><li class="masthead__menu-item">
              <a href="/datasets/">DATASETS</a>
            </li><li class="masthead__menu-item">
              <a href="/about/">ABOUT</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      
  







<div class="page__hero"
  style=" background-image: url('');"
>
  
    <img src="/images/lab.JPG" alt="Dissecting 28 years of European pharmaceutical development" class="page__hero-image">
  
  
</div>





<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/images/perfile.jpg" alt="Miquel Anglada Girotto" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Miquel Anglada Girotto</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>Biotechnologist specialized in Systems Biology</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Switzerland</span>
        </li>
      

      
        
          
        
          
        
          
            <li><a href="https://twitter.com/m1quelag" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
          
        
          
        
          
            <li><a href="https://github.com/MiqG" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Dissecting 28 years of European pharmaceutical development">
    <meta itemprop="description" content="European Medicines Agency, EMA, drug development, orphan drugs">
    <meta itemprop="datePublished" content="2020-05-21T00:00:00+02:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Dissecting 28 years of European pharmaceutical development
</h1>
          
            <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  8 minute read

</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <p><em>An exploration of data scrapped from the European Medicines Agency (EMA)</em></p>

<hr />

<p>Since the discovery of antibiotics, the availability of new drugs has substantially improved our lives. Drug development requires high investments that come with high uncertainty because we need to logically prove the safety and efficacy of new drug candidates before being freely administered in humans. Thus, pharmaceutical companies need to find a way through society’s health needs, international legal frameworks, and business motivations to succeed.</p>

<p>The European Medicines Agency (EMA) is the official regulator that directs drug development and decides whether to authorize marketing a new drug in Europe or not. In their webpage, they store information on every approved medicine and its corresponding marketing authorization holder (MAH) company.
To better understand the strategies implemented by successful European biotech companies and the EMA to keep developing new useful pharmaceuticals, I performed an exploratory analysis using information that I had previously scraped from EMA’s webpage on their 1222 drugs.</p>

<h2 id="emas-effective-advocacy-of-orphan-drug-development">EMA’s effective advocacy of orphan drug development</h2>

<p><img src="http://localhost:4000/images/2020-05-21-eda_ema_files/figure-markdown/unnamed-chunk-4-1.png" /></p>

<p>According to the EMA, a drug acquires the “orphan designation” status when it is “intended for use against a rare condition”. Unfortunately, due to the small number of people that suffer from these diseases, they are likely to be disregarded as they represent a small market. In 2000, the EMA established a series of incentives (see regulations) for those companies who endeavour to develop orphan drugs giving an economic interest to those therapeutic areas with a high risk of being neglected. Basically, they offer a special treatment that speeds up the bureaucratic part of the process and cuts down its overall cost. Indeed, we immediately see the effectiveness of this policy as the number of approved orphan drugs has steadily increased since then. Obviously, we cannot see how many equivalent-to-orphan drugs had been approved before their definition but the trend seems clear.</p>

<h2 id="complex-and-prevalent-diseases-retain-pharmas-interest">Complex and prevalent diseases retain pharma’s interest</h2>
<p>From the 414 different therapeutic areas for which the EMA has granted marketing authorizations, almost 20% of the approved drugs try to tackle only the 9 diseases listed in the figure below.</p>

<p><img src="http://localhost:4000/images/2020-05-21-eda_ema_files/figure-markdown/unnamed-chunk-5-1.png" /></p>

<p>What do all these diseases have in common? Their biological complexity; they are caused by multiple factors that can be very diverse across the population. Thus, the lack of a complete understanding of how they work makes it extremely hard to discover and develop drugs that fit for many patients. On the other hand, do pharmaceutical companies chose which disease to tackle only by their complexity? Probably, as mentioned above, they also take into account the number of people suffering from these conditions, which represents both the social impact of the disease itself and the market size for the drug. For example, the fact that, in 2018, 34.2 million US-citizens had diabetes, from which at least 90% of the cases correspond to type 2 diabetes may explain why most approved drugs are indicated for treating it. Especially for complex diseases, we expect to see these constant attempts to develop new and better drugs to enter a large market and be able to increase market share. It seems to be a win-win situation.</p>

<p>Out of curiosity, I further investigated what caused the peak in myocardial infarction drugs between 2005 and 2010. It was caused by the approval of 28 different generic drugs based on <em>clopidogrel</em>.</p>

<h2 id="drug-development-strategies-of-successful-companies">Drug development strategies of successful companies</h2>

<p>The number of approved marketing authorizations held by a pharmaceutical company can be considered as a measure of success since it indicates how well each company could navigate through the drug development process.</p>

<p><img src="http://localhost:4000/images/2020-05-21-eda_ema_files/figure-markdown/unnamed-chunk-6-1.png" /></p>

<p>The well-known Novartis approved 59 drugs with a rate of almost 3 drugs per year, from which none of them were generic. Conversely, Accord, the second pharma with the highest approval rate, approved 16 drugs in only 7 years. But, most of them (15 out of 16) were generic, which implies fewer studies and requirements than developing a completely new medicine. These were two examples of two very different strategies: Novartis has fully opted for innovation while Accord has opted for manufacturing many generics while developing fewer new drugs.</p>

<h2 id="diversify-or-die-really">Diversify or die, really?</h2>
<p>One common practice of venture capitalists is to diversify investments in order to spread the risk. Similarly, pharmaceutical companies have to choose which diseases they want to tackle.</p>

<p><img src="http://localhost:4000/images/2020-05-21-eda_ema_files/figure-markdown/unnamed-chunk-7-1.png" /></p>

<p>Developing drugs for different therapeutic areas ensures taking shares in many markets. We see how companies with a high approval rate and a high number of total approved drugs also own drugs involved in many therapeutic areas, which may be mostly related to the business side of drug development.</p>

<p><img src="http://localhost:4000/images/2020-05-21-eda_ema_files/figure-markdown/unnamed-chunk-8-1.png" /></p>

<p>In fact, most pharmaceutical companies choose to develop the same proportion of drugs than therapeutic areas or choose drug candidates with multiple indications. Then, after the approval of the medicine for the first indication, they do not need to go through the whole process again necessarily and increase the profits.</p>

<p>Not surprisingly, few companies have specialized in developing drugs for the same indications since it is a risky “business choice” that relies on the number and quality of competitors.</p>

<p>However, diversification of the therapeutic areas may become a double-edged sword. On the one side, finding new indications for approved drugs -also known as “drug repurposing”- maximizes and recycles the resources spent to go from bench to bedside and allows to increase the pool of available treatments for many diseases, which can help to cope with disease co-morbidities and secondary effects. On the other side, in the case that a drug cannot be repurposed, most biotech companies may have to start over developing new drugs that tackle different diseases in order to stay in business. Consequently, instead of leveraging their expertise, they may “repurpose” their trained teams to focus on a new, different aim and lose part of the experience acquired in the previous therapeutic area.</p>

<p>Diversification might slow down the overall advances in drug development to fulfill the business requirements. Nevertheless, what are the alternatives to the current model? Can we change it?</p>

<h2 id="exploratory-data-analysis-with-r">Exploratory Data Analysis with R</h2>

<p>For those who may wish to reproduce or further analyze these data.</p>

<ol>
  <li><strong>Load required libraries:</strong>
    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">require</span><span class="p">(</span><span class="n">tibble</span><span class="p">)</span><span class="w">
</span><span class="n">require</span><span class="p">(</span><span class="n">readr</span><span class="p">)</span><span class="w">
</span><span class="n">require</span><span class="p">(</span><span class="n">stringr</span><span class="p">)</span><span class="w">
</span><span class="n">require</span><span class="p">(</span><span class="n">ggpubr</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>
  </li>
  <li><strong>Prepare and wrangle data:</strong>
    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># download data</span><span class="w">
</span><span class="n">urlEMA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'https://raw.githubusercontent.com/MiqG/EMA-Data-Scratching-with-RSelenium/master/drug_df_EMA.csv'</span><span class="w">
</span><span class="n">ema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read_csv</span><span class="p">(</span><span class="n">urlEMA</span><span class="p">)</span><span class="w">
</span><span class="c1"># subset features of interest and change their names</span><span class="w">
</span><span class="n">featuresOI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s1">'Name'</span><span class="p">,</span><span class="w">
            </span><span class="s1">'Active substance'</span><span class="p">,</span><span class="w">
            </span><span class="s1">'International non-proprietary name (INN) or common name'</span><span class="p">,</span><span class="w">
            </span><span class="s1">'Generic'</span><span class="p">,</span><span class="w">
            </span><span class="s1">'Orphan'</span><span class="p">,</span><span class="w">
            </span><span class="s1">'Exceptional circumstances'</span><span class="p">,</span><span class="w">
            </span><span class="s1">'Countries'</span><span class="p">,</span><span class="w">
            </span><span class="s1">'Marketing-authorisation holder'</span><span class="p">,</span><span class="w">
            </span><span class="s1">'Therapeutic area (MeSH)'</span><span class="p">,</span><span class="w">
            </span><span class="s1">'Date of issue of marketing authorisation valid throughout the European Union'</span><span class="p">)</span><span class="w">
</span><span class="n">newColNames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s1">'name'</span><span class="p">,</span><span class="w">
             </span><span class="s1">'substance_act'</span><span class="p">,</span><span class="w">
             </span><span class="s1">'substance_inn'</span><span class="p">,</span><span class="w">
             </span><span class="s1">'generic'</span><span class="p">,</span><span class="w">
             </span><span class="s1">'orphan'</span><span class="p">,</span><span class="w">
             </span><span class="s1">'exceptional_circ'</span><span class="p">,</span><span class="w">
             </span><span class="s1">'country'</span><span class="p">,</span><span class="w">
             </span><span class="s1">'mah'</span><span class="p">,</span><span class="w">
             </span><span class="s1">'mesh'</span><span class="p">,</span><span class="w">
             </span><span class="s1">'date'</span><span class="p">)</span><span class="w">
</span><span class="n">ema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ema</span><span class="p">[</span><span class="n">featuresOI</span><span class="p">]</span><span class="w">
</span><span class="n">colnames</span><span class="p">(</span><span class="n">ema</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newColNames</span><span class="w">
</span><span class="n">ema</span><span class="o">$</span><span class="n">date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strptime</span><span class="p">(</span><span class="n">ema</span><span class="o">$</span><span class="n">date</span><span class="p">,</span><span class="w"> </span><span class="s1">'%d/%m/%Y'</span><span class="p">)</span><span class="w">
</span><span class="n">ema</span><span class="o">$</span><span class="n">year</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">format</span><span class="p">(</span><span class="n">ema</span><span class="o">$</span><span class="n">date</span><span class="p">,</span><span class="w"> </span><span class="s1">'%Y'</span><span class="p">))</span><span class="w">
</span><span class="n">ema</span><span class="o">$</span><span class="n">generic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">ema</span><span class="o">$</span><span class="n">generic</span><span class="p">)</span><span class="w">
</span><span class="n">ema</span><span class="o">$</span><span class="n">orphan</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">ema</span><span class="o">$</span><span class="n">orphan</span><span class="p">)</span><span class="w">
</span><span class="n">ema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ema</span><span class="p">[</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">ema</span><span class="o">$</span><span class="n">country</span><span class="p">),]</span><span class="w"> </span><span class="c1"># unsuccessful applications will have an empty Country</span><span class="w">
</span></code></pre></div>    </div>
  </li>
  <li><strong>Summarize data:</strong>
    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># study therapeutic areas</span><span class="w">
</span><span class="c1">## list drugs and their therapeutic area (MeSH)</span><span class="w">
</span><span class="n">mesh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lapply</span><span class="p">(</span><span class="n">ema</span><span class="o">$</span><span class="n">mesh</span><span class="p">,</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">meshTerms</span><span class="p">)</span><span class="w"> </span><span class="n">unlist</span><span class="p">(</span><span class="n">strsplit</span><span class="p">(</span><span class="n">meshTerms</span><span class="p">,</span><span class="w"> </span><span class="n">split</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'\n'</span><span class="p">))</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="nf">names</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ema</span><span class="o">$</span><span class="n">name</span><span class="w">
</span><span class="c1">## get their frequency percentages</span><span class="w">
</span><span class="n">mesh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">table</span><span class="p">(</span><span class="n">unlist</span><span class="p">(</span><span class="n">mesh</span><span class="p">))</span><span class="w">
</span><span class="n">mesh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mesh</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">100</span><span class="w">
</span><span class="n">mesh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sort</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span><span class="w"> </span><span class="n">decreasing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span><span class="n">mesh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tibble</span><span class="p">(</span><span class="n">therArea</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">names</span><span class="p">(</span><span class="n">mesh</span><span class="p">),</span><span class="w">
           </span><span class="n">perc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mesh</span><span class="p">)</span><span class="w">
</span><span class="c1"># study approved drugs per therapeutic area per year</span><span class="w">
</span><span class="n">years</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">ema</span><span class="o">$</span><span class="n">year</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="o">:</span><span class="nf">max</span><span class="p">(</span><span class="n">ema</span><span class="o">$</span><span class="n">year</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span><span class="n">therArea_perc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">paste0</span><span class="p">(</span><span class="n">mesh</span><span class="o">$</span><span class="n">therArea</span><span class="p">,</span><span class="s1">' ('</span><span class="p">,</span><span class="nf">round</span><span class="p">(</span><span class="n">mesh</span><span class="o">$</span><span class="n">perc</span><span class="p">,</span><span class="m">2</span><span class="p">),</span><span class="s1">'%)'</span><span class="p">)</span><span class="w">
</span><span class="n">meshApproved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expand.grid</span><span class="p">(</span><span class="n">therArea_perc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="n">therArea_perc</span><span class="p">,</span><span class="w"> </span><span class="n">levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">therArea_perc</span><span class="p">),</span><span class="w"> 
                        </span><span class="n">year</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">years</span><span class="p">)</span><span class="w">
</span><span class="n">meshApproved</span><span class="o">$</span><span class="n">therArea</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsub</span><span class="p">(</span><span class="s1">' \\(.*'</span><span class="p">,</span><span class="s1">''</span><span class="p">,</span><span class="nf">as.character</span><span class="p">(</span><span class="n">meshApproved</span><span class="o">$</span><span class="n">therArea_perc</span><span class="p">))</span><span class="w">
</span><span class="n">meshApproved</span><span class="o">$</span><span class="n">nApprovedDrugs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sapply</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="n">nrow</span><span class="p">(</span><span class="n">meshApproved</span><span class="p">),</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">idxRow</span><span class="p">){</span><span class="w"> 
 </span><span class="nf">sum</span><span class="p">(</span><span class="w"> </span><span class="n">str_count</span><span class="p">(</span><span class="n">ema</span><span class="o">$</span><span class="n">mesh</span><span class="p">[</span><span class="n">ema</span><span class="o">$</span><span class="n">year</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">meshApproved</span><span class="o">$</span><span class="n">year</span><span class="p">[</span><span class="n">idxRow</span><span class="p">]],</span><span class="w"> </span><span class="n">pattern</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.character</span><span class="p">(</span><span class="n">meshApproved</span><span class="o">$</span><span class="n">therArea</span><span class="p">[</span><span class="n">idxRow</span><span class="p">])),</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> 
 </span><span class="p">})</span><span class="w">
</span><span class="c1"># study pharmaceutical companies</span><span class="w">
</span><span class="n">mahCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sort</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="n">ema</span><span class="o">$</span><span class="n">mah</span><span class="p">),</span><span class="w"> </span><span class="n">decreasing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span><span class="n">mahCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tibble</span><span class="p">(</span><span class="n">nApprovedDrugs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">mahCount</span><span class="p">),</span><span class="w"> </span><span class="n">mah</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="nf">names</span><span class="p">(</span><span class="n">mahCount</span><span class="p">),</span><span class="w"> </span><span class="n">levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">names</span><span class="p">(</span><span class="n">mahCount</span><span class="p">)))</span><span class="w">
</span><span class="n">mahCount</span><span class="o">$</span><span class="n">deltaTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sapply</span><span class="p">(</span><span class="n">mahCount</span><span class="o">$</span><span class="n">mah</span><span class="p">,</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">mah</span><span class="p">)</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">ema</span><span class="o">$</span><span class="n">year</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">ema</span><span class="o">$</span><span class="n">year</span><span class="p">[</span><span class="n">ema</span><span class="o">$</span><span class="n">mah</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">mah</span><span class="p">])</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="n">mahCount</span><span class="o">$</span><span class="n">approvalRate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">mahCount</span><span class="o">$</span><span class="n">nApprovedDrugs</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">mahCount</span><span class="o">$</span><span class="n">deltaTime</span><span class="p">)</span><span class="w">
</span><span class="n">mahCount</span><span class="o">$</span><span class="n">approvalRate</span><span class="p">[</span><span class="n">mahCount</span><span class="o">$</span><span class="n">deltaTime</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="m">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="w">
</span><span class="n">mahCount</span><span class="o">$</span><span class="n">weightedApprovalRate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mahCount</span><span class="o">$</span><span class="n">approvalRate</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mahCount</span><span class="o">$</span><span class="n">nApprovedDrugs</span><span class="w">
</span><span class="n">mahCount</span><span class="o">$</span><span class="n">nTherAreas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sapply</span><span class="p">(</span><span class="n">mahCount</span><span class="o">$</span><span class="n">mah</span><span class="p">,</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">mah</span><span class="p">)</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">unique</span><span class="p">(</span><span class="n">unlist</span><span class="p">(</span><span class="n">strsplit</span><span class="p">(</span><span class="n">ema</span><span class="o">$</span><span class="n">mesh</span><span class="p">[</span><span class="n">ema</span><span class="o">$</span><span class="n">mah</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">mah</span><span class="p">],</span><span class="w"> </span><span class="n">split</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'\n'</span><span class="p">))))</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="n">mahCount</span><span class="o">$</span><span class="n">module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">((</span><span class="n">mahCount</span><span class="o">$</span><span class="n">approvalRate</span><span class="o">/</span><span class="nf">sum</span><span class="p">(</span><span class="n">mahCount</span><span class="o">$</span><span class="n">approvalRate</span><span class="p">))</span><span class="o">^</span><span class="m">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">mahCount</span><span class="o">$</span><span class="n">nTherAreas</span><span class="o">/</span><span class="nf">sum</span><span class="p">(</span><span class="n">mahCount</span><span class="o">$</span><span class="n">nTherAreas</span><span class="p">))</span><span class="o">^</span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">mahCount</span><span class="o">$</span><span class="n">nTherAreaPerDrug</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mahCount</span><span class="o">$</span><span class="n">nTherAreas</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">mahCount</span><span class="o">$</span><span class="n">nApprovedDrugs</span><span class="w">
</span><span class="n">mahCount</span><span class="o">$</span><span class="n">strategy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="w">
</span><span class="n">mahCount</span><span class="o">$</span><span class="n">strategy</span><span class="p">[</span><span class="n">mahCount</span><span class="o">$</span><span class="n">nTherAreaPerDrug</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'&gt;1'</span><span class="w">
</span><span class="n">mahCount</span><span class="o">$</span><span class="n">strategy</span><span class="p">[</span><span class="n">mahCount</span><span class="o">$</span><span class="n">nTherAreaPerDrug</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'=1'</span><span class="w">
</span><span class="n">mahCount</span><span class="o">$</span><span class="n">strategy</span><span class="p">[</span><span class="n">mahCount</span><span class="o">$</span><span class="n">nTherAreaPerDrug</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'&lt;1'</span><span class="w">
</span></code></pre></div>    </div>
  </li>
  <li><strong>Make figures</strong>
    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># variables</span><span class="w">
</span><span class="n">baseSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">9</span><span class="w">
</span><span class="c1"># orphan drugs</span><span class="w">
</span><span class="n">perc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="nf">sum</span><span class="p">(</span><span class="n">ema</span><span class="o">$</span><span class="n">orphan</span><span class="p">)</span><span class="o">/</span><span class="n">nrow</span><span class="p">(</span><span class="n">ema</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">100</span><span class="p">,</span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">figTitle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">paste0</span><span class="p">(</span><span class="s1">'Approved orphan drugs ('</span><span class="p">,</span><span class="n">perc</span><span class="p">,</span><span class="s1">'%)'</span><span class="p">)</span><span class="w">
</span><span class="n">plt1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ggplot</span><span class="p">(</span><span class="n">ema</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orphan</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orphan</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> 
    </span><span class="n">geom_bar</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">scale_fill_viridis_d</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">ggtitle</span><span class="p">(</span><span class="n">figTitle</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">theme_pubr</span><span class="p">(</span><span class="n">legend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'none'</span><span class="p">,</span><span class="w"> </span><span class="n">base_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">baseSize</span><span class="p">)</span><span class="w">
</span><span class="n">figTitle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Evolution of orphan drugs'</span><span class="w">
</span><span class="n">plt2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ggplot</span><span class="p">(</span><span class="n">ema</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">year</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orphan</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> 
    </span><span class="n">geom_bar</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">scale_fill_viridis_d</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">ggtitle</span><span class="p">(</span><span class="n">figTitle</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">theme_pubr</span><span class="p">(</span><span class="n">legend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'bottom'</span><span class="p">,</span><span class="w"> </span><span class="n">base_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">baseSize</span><span class="p">)</span><span class="w">
</span><span class="n">ggarrange</span><span class="p">(</span><span class="n">plt1</span><span class="p">,</span><span class="w"> </span><span class="n">plt2</span><span class="p">,</span><span class="w"> </span><span class="n">common.legend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span><span class="c1"># therapeutic areas</span><span class="w">
</span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">9</span><span class="w">
</span><span class="n">figTitle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">paste0</span><span class="p">(</span><span class="s1">'Evolution of drug approvals in top '</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="s1">' therapeutic areas'</span><span class="p">)</span><span class="w">
</span><span class="n">idxTherAreas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">meshApproved</span><span class="o">$</span><span class="n">therArea</span><span class="w"> </span><span class="o">%in%</span><span class="w">  </span><span class="n">mesh</span><span class="o">$</span><span class="n">therArea</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="n">n</span><span class="p">]</span><span class="w">
</span><span class="n">ggline</span><span class="p">(</span><span class="n">meshApproved</span><span class="p">[</span><span class="n">idxTherAreas</span><span class="p">,],</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'year'</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'nApprovedDrugs'</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'therArea'</span><span class="p">,</span><span class="w"> 
    </span><span class="n">facet.by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'therArea_perc'</span><span class="p">,</span><span class="w"> </span><span class="n">point.size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.1</span><span class="p">,</span><span class="w">
    </span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">figTitle</span><span class="p">,</span><span class="w"> </span><span class="n">linetype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'dashed'</span><span class="p">,</span><span class="w"> </span><span class="n">palette</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'jco'</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">theme_pubr</span><span class="p">(</span><span class="n">base_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">baseSize</span><span class="p">,</span><span class="w"> </span><span class="n">x.text.angle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">45</span><span class="p">,</span><span class="w"> </span><span class="n">legend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'none'</span><span class="p">)</span><span class="w">
</span><span class="c1"># pharmas</span><span class="w">
</span><span class="c1">## n mahs and approval rates</span><span class="w">
</span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="w">
</span><span class="n">mahCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mahCount</span><span class="p">[</span><span class="n">order</span><span class="p">(</span><span class="n">mahCount</span><span class="o">$</span><span class="n">nApprovedDrugs</span><span class="p">,</span><span class="w"> </span><span class="n">decreasing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),]</span><span class="w">
</span><span class="n">levels</span><span class="p">(</span><span class="n">mahCount</span><span class="o">$</span><span class="n">mah</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mahCount</span><span class="o">$</span><span class="n">mah</span><span class="w">
</span><span class="n">figTitle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">paste</span><span class="p">(</span><span class="s1">'Top 10 Marketing Authorization Holders'</span><span class="p">)</span><span class="w">
</span><span class="n">plt1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ggplot</span><span class="p">(</span><span class="n">mahCount</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="n">n</span><span class="p">,],</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mah</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nApprovedDrugs</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> 
    </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'identity'</span><span class="p">,</span><span class="n">fill</span><span class="o">=</span><span class="s1">'orange'</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">ggtitle</span><span class="p">(</span><span class="n">figTitle</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">theme_pubr</span><span class="p">(</span><span class="n">legend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'bottom'</span><span class="p">,</span><span class="w"> </span><span class="n">x.text.angle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">67</span><span class="p">,</span><span class="w"> </span><span class="n">base_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">baseSize</span><span class="p">)</span><span class="w">
</span><span class="n">dat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mahCount</span><span class="p">[</span><span class="o">!</span><span class="nf">is.infinite</span><span class="p">(</span><span class="n">mahCount</span><span class="o">$</span><span class="n">approvalRate</span><span class="p">),]</span><span class="w">
</span><span class="n">dat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dat</span><span class="p">[</span><span class="n">order</span><span class="p">(</span><span class="n">dat</span><span class="o">$</span><span class="n">approvalRate</span><span class="p">,</span><span class="w"> </span><span class="n">decreasing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),]</span><span class="w">
</span><span class="n">dat</span><span class="o">$</span><span class="n">mah</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="n">dat</span><span class="o">$</span><span class="n">mah</span><span class="p">,</span><span class="w"> </span><span class="n">levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dat</span><span class="o">$</span><span class="n">mah</span><span class="p">)</span><span class="w"> 
</span><span class="n">figTitle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">paste</span><span class="p">(</span><span class="s1">'Top 10 Approval Rate'</span><span class="p">)</span><span class="w">
</span><span class="n">plt2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ggplot</span><span class="p">(</span><span class="n">dat</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="n">n</span><span class="p">,],</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mah</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">approvalRate</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> 
    </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'identity'</span><span class="p">,</span><span class="n">fill</span><span class="o">=</span><span class="s1">'orange'</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">ggtitle</span><span class="p">(</span><span class="n">figTitle</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">theme_pubr</span><span class="p">(</span><span class="n">legend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'bottom'</span><span class="p">,</span><span class="w"> </span><span class="n">x.text.angle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">67</span><span class="p">,</span><span class="w"> </span><span class="n">base_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">baseSize</span><span class="p">)</span><span class="w">
</span><span class="n">figTitle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">paste</span><span class="p">(</span><span class="s1">'Marketing Authorization Holders out of'</span><span class="p">,</span><span class="w"> </span><span class="n">nrow</span><span class="p">(</span><span class="n">mahCount</span><span class="p">),</span><span class="w"> </span><span class="s1">'companies'</span><span class="p">)</span><span class="w">
</span><span class="n">annotate_figure</span><span class="p">(</span><span class="n">ggarrange</span><span class="p">(</span><span class="n">plt1</span><span class="p">,</span><span class="w"> </span><span class="n">plt2</span><span class="p">),</span><span class="w"> </span><span class="n">top</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">figTitle</span><span class="p">)</span><span class="w">
</span><span class="c1">## diversification</span><span class="w">
</span><span class="c1">### scatter</span><span class="w">
</span><span class="n">topNmah</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mahCount</span><span class="o">$</span><span class="n">mah</span><span class="p">[</span><span class="n">order</span><span class="p">(</span><span class="n">mahCount</span><span class="o">$</span><span class="n">module</span><span class="p">,</span><span class="w"> </span><span class="n">decreasing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)][</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">]</span><span class="w">
</span><span class="n">plt1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ggscatter</span><span class="p">(</span><span class="n">mahCount</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'approvalRate'</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'nApprovedDrugs'</span><span class="p">,</span><span class="w">
       </span><span class="n">add</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'reg.line'</span><span class="p">,</span><span class="w"> </span><span class="n">conf.int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">add.params</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">linetype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'dashed'</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'lightgray'</span><span class="p">),</span><span class="w">
       </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'mah'</span><span class="p">,</span><span class="w"> </span><span class="n">label.select</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">topNmah</span><span class="p">,</span><span class="w"> </span><span class="n">font.label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="s1">'darkorange'</span><span class="p">),</span><span class="w"> 
       </span><span class="n">repel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">label.rectangle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.75</span><span class="p">,</span><span class="w">
       </span><span class="n">theme</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">theme_pubr</span><span class="p">(</span><span class="n">base_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">baseSize</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
       </span><span class="n">stat_regline_equation</span><span class="p">(</span><span class="n">label.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">label.y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w">
</span><span class="n">plt2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ggscatter</span><span class="p">(</span><span class="n">mahCount</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'approvalRate'</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'nTherAreas'</span><span class="p">,</span><span class="w">
       </span><span class="n">add</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'reg.line'</span><span class="p">,</span><span class="w"> </span><span class="n">conf.int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">add.params</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">linetype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'dashed'</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'lightgray'</span><span class="p">),</span><span class="w">
       </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'mah'</span><span class="p">,</span><span class="w"> </span><span class="n">label.select</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">topNmah</span><span class="p">,</span><span class="w"> </span><span class="n">font.label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="s1">'darkorange'</span><span class="p">),</span><span class="w"> 
       </span><span class="n">repel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">label.rectangle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.75</span><span class="p">,</span><span class="w">
       </span><span class="n">theme</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">theme_pubr</span><span class="p">(</span><span class="n">base_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">baseSize</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
       </span><span class="n">stat_regline_equation</span><span class="p">(</span><span class="n">label.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">label.y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w"> 
</span><span class="n">figTitle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">paste</span><span class="p">(</span><span class="s1">'Diversification in therapeutic areas of\nsuccessful pharmaceutical companies'</span><span class="p">)</span><span class="w">
</span><span class="n">annotate_figure</span><span class="p">(</span><span class="n">ggarrange</span><span class="p">(</span><span class="n">plt1</span><span class="p">,</span><span class="w"> </span><span class="n">plt2</span><span class="p">),</span><span class="w"> </span><span class="n">top</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">figTitle</span><span class="p">)</span><span class="w">
</span><span class="c1">### bar plot</span><span class="w">
</span><span class="n">figTitle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Therapeutic areas per approved drug\nacross European pharmas'</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">mahCount</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">strategy</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strategy</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_bar</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">ggtitle</span><span class="p">(</span><span class="n">figTitle</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">theme_pubr</span><span class="p">(</span><span class="n">x.text.angle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">legend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'none'</span><span class="p">,</span><span class="w"> </span><span class="n">base_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">baseSize</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>
  </li>
</ol>

        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#data-analysis" class="page__taxonomy-item" rel="tag">Data Analysis</a>
    
    </span>
  </p>




        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2020-05-21T00:00:00+02:00">May 21, 2020</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=Dissecting+28+years+of+European+pharmaceutical+development%20http%3A%2F%2Flocalhost%3A4000%2Feda_ema%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Feda_ema%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Feda_ema%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You may also enjoy</h4>
      <div class="grid__wrapper">
        
          
            
      </div>
    </div>
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
          <li><a href="https://twitter.com/m1quelag" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
      
        
          <li><a href="https://github.com/MiqG" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
      
        
      
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2020 Miquel Anglada Girotto. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script src="https://kit.fontawesome.com/4eee35f757.js"></script>










<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>



  </body>
</html>
